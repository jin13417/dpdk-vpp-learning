<mxfile host="app.diagrams.net" modified="2021-10-25T03:11:59.984Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36" etag="VDeouFUnuXGDErfQQX4u" version="15.5.8" type="github">
  <diagram name="Page-1" id="e7e014a7-5840-1c2e-5031-d8a46d1fe8dd">
    <mxGraphModel dx="782" dy="436" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="826" background="#ffffff" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-41" value="ikev2_main_t" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="80" y="90" width="310" height="552" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-42" value="ikev2_profile_t *profiles&#xa;ikev2 profiles 配置pool内存池" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="26" width="310" height="44" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-44" value="ikev2_sa_transform_t *supported_transforms&#xa;vector结构，默认初始化加密、认证、DH、完整性检测算法" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="70" width="310" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-45" value="mhash_t profile_index_by_name;&#xa;mhash &lt;key:name,value:profiles pool id&gt;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="120" width="310" height="42" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-46" value="EVP_PKEY *pkey;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="162" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-47" value="vlib_main_t *vlib_main" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="188" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-48" value="vnet_main_t *vnet_main" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="214" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-49" value="ikev2_sa_t *sais" style="text;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#b85450;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="240" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-50" value="uword *sa_by_ispi；hash结构" style="text;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#b85450;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="266" width="310" height="34" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-51" value="ikev2_main_per_thread_data_t *per_thread_data" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="300" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-52" value="uword *sw_if_indices；hash结构，ike管理接口" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="326" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-53" value="u16 msg_id_base；vapi 消息id基地址" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="352" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-54" value="vlib_log_class_t log_class" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="378" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-55" value="ikev2_log_level_t log_level" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="404" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-56" value="u32 liveness_period；ipsec保活检查周期，默认30s" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="430" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-57" value="u32 liveness_max_retries；保活检查最大次数，默认3" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="456" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-58" value="u8 dpd_disabled" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="482" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-59" value="int (*dns_resolve_name) () ，用于ikev2 response &#xa;使用域名获取ip地址，使用nds 插件。" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-41" vertex="1">
          <mxGeometry y="508" width="310" height="44" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-60" value="ikev2_profile_t" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;strokeColor=#b85450;fillColor=#f8cecc;" parent="1" vertex="1">
          <mxGeometry x="530" y="80" width="270" height="442" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-61" value="u8 *name" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="26" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-63" value="ikev2_auth_t auth" style="text;fillColor=#dae8fc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#6c8ebf;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="52" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-64" value="ikev2_id_t loc_id；本地标识" style="text;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#b85450;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="78" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-65" value="ikev2_id_t rem_id；远端标识" style="text;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#b85450;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="104" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-66" value="ikev2_ts_t loc_ts；本地流量选择器" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="130" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-67" value="ikev2_ts_t rem_ts；远端流量选择器" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="156" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-68" value="ikev2_responder_t responder" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="182" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-69" value="ikev2_transforms_set ike_ts" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="208" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-70" value="ikev2_transforms_set esp_ts" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="234" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-71" value="u64 lifetime;ipsec sa 生命周期&#xa;u64 lifetime_maxdata;&#xa;u32 lifetime_jitter;过期时间延迟大小" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="260" width="270" height="52" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-72" value="u32 handover" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="312" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-73" value="u16 ipsec_over_udp_port；udp端口号" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="338" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-74" value="u32 tun_itf，ipsec隧道接口索引" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="364" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-75" value="u8 udp_encap；ipsec传输模式是否使用udp封装" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="390" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-76" value="u8 natt_disabled；1：表示关闭natt功能" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-60" vertex="1">
          <mxGeometry y="416" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-77" value="ikev2_auth_t&#xa;认证数据" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=37;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;strokeColor=#6c8ebf;fillColor=#dae8fc;" parent="1" vertex="1">
          <mxGeometry x="830" y="10" width="240" height="162" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-78" value="ikev2_auth_method_t method:8&#xa;认证方式：1：RSA签名，2：共享密钥" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="Ou4qxV2DXJZPpHNbIq72-77" vertex="1">
          <mxGeometry y="37" width="240" height="33" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-80" value="u8 *data；1、RSA签名文件名，&#xa;2：共享数据" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="Ou4qxV2DXJZPpHNbIq72-77" vertex="1">
          <mxGeometry y="70" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-81" value="u8 hex; 2、共享密钥16进制编码" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="Ou4qxV2DXJZPpHNbIq72-77" vertex="1">
          <mxGeometry y="110" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-82" value="EVP_PKEY *key；1，RSA签名key" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="Ou4qxV2DXJZPpHNbIq72-77" vertex="1">
          <mxGeometry y="136" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-83" value="ikev2_id_t" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;strokeColor=#b85450;fillColor=#f8cecc;" parent="1" vertex="1">
          <mxGeometry x="830" y="186" width="240" height="78" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-84" value="ikev2_id_type_t type:8；标识类型" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="Ou4qxV2DXJZPpHNbIq72-83" vertex="1">
          <mxGeometry y="26" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ou4qxV2DXJZPpHNbIq72-86" value="u8 *data;  对应的数据内容" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="Ou4qxV2DXJZPpHNbIq72-83" vertex="1">
          <mxGeometry y="52" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-1" value="ikev2_ts_t" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;strokeColor=#6c8ebf;fillColor=#dae8fc;" parent="1" vertex="1">
          <mxGeometry x="1110" y="10" width="190" height="176" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-2" value="ts_type：ipv4 或ipv6" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-1" vertex="1">
          <mxGeometry y="26" width="190" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-3" value="u8 protocol_id;协议号" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="qKSq34PAnrU9pz3v25Dv-1" vertex="1">
          <mxGeometry y="52" width="190" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-4" value="u16 selector_len;" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-1" vertex="1">
          <mxGeometry y="78" width="190" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-5" value="u16 start_port;&#xa;u16 end_port; 起始端口号" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-1" vertex="1">
          <mxGeometry y="104" width="190" height="36" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-6" value="ip_address_t start_addr;&#xa;ip_address_t end_addr;起始ip地址" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-1" vertex="1">
          <mxGeometry y="140" width="190" height="36" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-7" value="ikev2_responder_t" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;strokeColor=#6c8ebf;fillColor=#dae8fc;" parent="1" vertex="1">
          <mxGeometry x="830" y="276" width="240" height="150" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-8" value="u32 sw_if_index;接口索引" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-7" vertex="1">
          <mxGeometry y="26" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-9" value="ip_address_t addr;IP地址" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="qKSq34PAnrU9pz3v25Dv-7" vertex="1">
          <mxGeometry y="52" width="240" height="28" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-10" value="u8 *hostname;域名" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-7" vertex="1">
          <mxGeometry y="80" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-11" value="u8 is_resolved;1、标识使用ip地址，&#xa;0：使用域名，调用dns插件接口获取ip地址" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-7" vertex="1">
          <mxGeometry y="110" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-12" value="ikev2_transforms_set" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;strokeColor=#6c8ebf;fillColor=#dae8fc;" parent="1" vertex="1">
          <mxGeometry x="830" y="440" width="350" height="132" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-13" value="ikev2_transform_encr_type_t crypto_alg;加密算法类型" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-12" vertex="1">
          <mxGeometry y="26" width="350" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-14" value="ikev2_transform_integ_type_t integ_alg;完整性算法类型" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" parent="qKSq34PAnrU9pz3v25Dv-12" vertex="1">
          <mxGeometry y="52" width="350" height="28" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-15" value="ikev2_transform_dh_type_t dh_type;Diffie-Hellman组类型" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-12" vertex="1">
          <mxGeometry y="80" width="350" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-16" value="u32 crypto_key_size;加密算法key长度" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-12" vertex="1">
          <mxGeometry y="106" width="350" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-17" value="ikev2_main_per_thread_data_t&#xa;线程数据" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;strokeColor=#6c8ebf;fillColor=#dae8fc;" parent="1" vertex="1">
          <mxGeometry x="450" y="570" width="350" height="146" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-18" value="ikev2_sa_t *sas;   ipsec sa信息 pool 内存池" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-17" vertex="1">
          <mxGeometry y="40" width="350" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-19" value="uword *sa_by_rspi;  hash  &lt;key：rspi，value：sas pool id&gt;" style="text;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#b85450;" parent="qKSq34PAnrU9pz3v25Dv-17" vertex="1">
          <mxGeometry y="66" width="350" height="28" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-20" value="EVP_CIPHER_CTX *evp_ctx;openssl EVP_CIPHER 上下文" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-17" vertex="1">
          <mxGeometry y="94" width="350" height="26" as="geometry" />
        </mxCell>
        <mxCell id="qKSq34PAnrU9pz3v25Dv-21" value="HMAC_CTX *hmac_ctx; hash mac 散列消息认证上下文索引" style="text;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="qKSq34PAnrU9pz3v25Dv-17" vertex="1">
          <mxGeometry y="120" width="350" height="26" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-1" value="ipsec_main_t" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="40" y="850" width="310" height="896" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-2" value="ipsec_spd_t *spds; ikev1使用spd方式，查询到sad索引&#xa;pool内存池" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="26" width="310" height="44" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-3" value="ipsec_sa_t *sad; ikev1、ikev2 ipsec 加解密sa信息&#xa;pool内存池" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="70" width="310" height="40" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-4" value="ipsec_tunnel_if_t *tunnel_interfaces;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="110" width="310" height="42" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-5" value=" u32 *free_tunnel_if_indices;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="152" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-6" value="u32 **empty_buffers;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="178" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-7" value="uword *tunnel_index_by_key;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="204" width="310" height="26" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-8" value="vlib_main_t *vlib_main;&#xa;  vnet_main_t *vnet_main;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="230" width="310" height="40" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-9" value="u32 feature_next_node_index[32];" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="270" width="310" height="34" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-10" value="  uword *spd_index_by_spd_id;&#xa;  uword *spd_index_by_sw_if_index;&#xa;  uword *sa_index_by_sa_id;" style="text;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#b85450;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="304" width="310" height="56" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-11" value="uword *ipsec_if_pool_index_by_key;&#xa;  uword *ipsec_if_real_dev_by_show_dev;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="360" width="310" height="40" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-12" value="  u32 error_drop_node_index;&#xa;  u32 esp4_encrypt_node_index;&#xa;  u32 esp4_decrypt_node_index;&#xa;  u32 ah4_encrypt_node_index;&#xa;  u32 ah4_decrypt_node_index;&#xa;  u32 esp6_encrypt_node_index;&#xa;  u32 esp6_decrypt_node_index;&#xa;  u32 ah6_encrypt_node_index;&#xa;  u32 ah6_decrypt_node_index;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="400" width="310" height="140" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-19" value="  u32 esp4_encrypt_next_index;&#xa;  u32 esp4_decrypt_next_index;&#xa;  u32 ah4_encrypt_next_index;&#xa;  u32 ah4_decrypt_next_index;&#xa;  u32 esp6_encrypt_next_index;&#xa;  u32 esp6_decrypt_next_index;&#xa;  u32 ah6_encrypt_next_index;&#xa;  u32 ah6_decrypt_next_index;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="540" width="310" height="140" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-20" value="  /* pool of ah backends */&#xa;  ipsec_ah_backend_t *ah_backends;&#xa;  /* pool of esp backends */&#xa;  ipsec_esp_backend_t *esp_backends;&#xa;  /* index of current ah backend */&#xa;  u32 ah_current_backend;&#xa;  /* index of current esp backend */&#xa;  u32 esp_current_backend;&#xa;  /* index of default ah backend */&#xa;  u32 ah_default_backend;&#xa;  /* index of default esp backend */&#xa;  u32 esp_default_backend;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="680" width="310" height="190" as="geometry" />
        </mxCell>
        <mxCell id="MuHBfX6KDJMft4iVepfN-13" value="ipsec_spd_t *spd_to_sort;" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeColor=#d6b656;" vertex="1" parent="MuHBfX6KDJMft4iVepfN-1">
          <mxGeometry y="870" width="310" height="26" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
